<!DOCTYPE html>
<html lang="es">
  <head>
      <meta charset="UTF-8">
      <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
      <script src="http://ajax.aspnetcdn.com/ajax/jquery.ui/1.8.9/jquery-ui.js" type="text/javascript"></script>
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
      <link rel="stylesheet" href="/css/index.css" media="screen"/>
  </head>
  <body>
    <%- include("menu2") %>
    <div class="contenido  m-0 vh-100 row justify-content-center align-items-center">
      <div class="card text-bg-light border-dark mb-3 col-auto" style="max-width: 1080px;">
        <h3> <span class="position-absolute top-0 start-50 translate-middle badge rounded-pill bg-success">Puntuacion: <%=pelicula.puntuacion%></span></h3>
        <div class="row g-0">
          <div class="col-md-4">
            <div class="containerGridCard">
              <article class="imgCardContainer">
                <a class="titleCard" href="#"><%= pelicula.nombre.toUpperCase() %></a>
                <div class="imgCard">
                  <a href="#">
                    <img src="data:image/jpeg; base64, <%= ((new Buffer(pelicula.img)).toString('base64')) %>" class="img-fluid rounded-start imgCard" alt="...">
                  </a>
                  </div>
              </article>
            </div>
          </div>
          <div class="col-md-8">
            <div class="card-body">
              <h5 class="card-title"><%=pelicula.nombre%></h5>
              <p class="card-text"><%=pelicula.sinopsis%></p>
              <!-- getFullYear() -->
              <p class="card-text"><small class="text-muted">Año de estreno: <%=pelicula.fechaEstreno.getFullYear()%> | <%=pelicula.duracion%> minutos | <%=pelicula.genero%></small></p>
            </div>
            <div class="card-body">
              <h5 class="card-title">Actores</h5>
              <ul class="list-group list-group-flush">
                <% actoresV.forEach(function(actor) { %>
                <li class="list-group-item"><%=actor.nombreAct%> <%=actor.apellidosAct%></li>
                <% }); %>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
    <form method="post" action="/films/getFilmById/<%= pelicula.id %>/rateFilm" class="row align-items-center">
      <div class="col col-2 offset-3 text-center"><strong>Valorar película:</strong></div>
      <div class="col col-4">
        <% for (let i = 0; i < 11; i++) { %>
          <input type="submit" class="btn btn-primary" name="punctuation" value="<%= i %>">
        <% } %>
      </div>
      <div class="col col-3 text-success"><strong><%= message %></strong></div>
    </form>
    <button onclick="mostrarComentarios()">+Comentarios</button>
    <div id="seccionComentarios">
      <div id="listaComentarios">
        <% if (comentariosV.length === 0) { %>
          <h2>Sin comentarios</h2>
        <% } else { %>
          <% comentariosV.forEach(function(comentariosV) { %>
            <div class="comentario">
              <div class="nombre-usuario"><%=comentariosV.username%></div>
              <div class="fecha-comentario"><%=comentariosV.fecha%></div>
              <div class="texto-comentario"><%=comentariosV.texto%></div>
            </div>
          <% }); %> 
        <% } %>
      </div>
    </div>
  </body>
</html>